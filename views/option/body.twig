{# macro for generating tab bodies#}
{% macro create(prefix, isProfile) %}

    <div ng-controller="AjaxController">

    {% import "option/group.twig" as group %}

    {% set grouping = getOptionsGrouping() %}
    {% set isOnNetworkDashboard = isOnNetworkDashboard() %}

    {# Create all tab bodies #}
    {% for tabName, optionGroups in grouping if isOptionGroupVisible(optionGroups) %}
        {# Create a tab body #}
        {% set tabId = 'tab_body_' ~ prefix ~ '__' ~ loop.index0 %}

        {% if loop.first %}
            {% set style = '' %}
        {% else %}
            {% set style = 'display: none' %}
        {% endif %}

        {% set tabId = 'tab_body_' ~ prefix ~ '__' ~ loop.index0 %}

        <div id="{{ tabId }}" class="tab-body" style="{{ style }}" ng-controller="{{ optionGroups.angular_controller|raw }}">
            {{ group.create(optionGroups, isProfile) }}
        {% if isOnNetworkDashboard %}
            <button class="button button-primary" busy-disabled="true" busy="{{ 'Please wait...'|__ }}" ng-disabled="isSaveDisabled" ng-click="$parent.save()">Save</button>
            <span ng-hide="!isSaveDisabled" style="color: red">You have to verify the connection to the AD before saving.</span>
        {% else %}
            <button class="button button-primary" busy-disabled="true" busy="{{ 'Please wait...'|__ }}" ng-disabled="(isSaveDisabled && permission.verification_username == 3 && permission.verification_password == 3)" ng-click="$parent.save()">Save</button>
            <span ng-hide="(!isSaveDisabled || permission.verification_username != 3 && permission.verification_password != 3)" style="color: red">You have to verify the connection to the AD before saving.</span>
        {% endif %}
        </div>

    {% endfor %}
    </div>


{% endmacro %}